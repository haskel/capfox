# Capfox Configuration Example

server:
  host: "0.0.0.0"
  port: 8080
  pid_file: "/var/run/capfox.pid"
  profiling:
    enabled: false  # Enable pprof endpoints at /debug/pprof/

auth:
  enabled: false
  # Use environment variables for sensitive data
  user: "${CAPFOX_AUTH_USER}"
  password: "${CAPFOX_AUTH_PASSWORD}"

thresholds:
  cpu:
    max_percent: 80
  memory:
    max_percent: 85
  gpu:
    max_percent: 90
  vram:
    max_percent: 85
  storage:
    min_free_gb: 10

monitoring:
  interval_ms: 1000
  paths:
    - "/"

persistence:
  data_dir: "/var/lib/capfox"
  flush_interval_sec: 600

logging:
  level: "info"    # debug, info, warn, error
  format: "json"   # json, text

learning:
  model: "moving_average"  # moving_average, linear_regression
  observation_delay_sec: 5

# Debug Mode Configuration
# WARNING: Debug mode exposes sensitive information. Always use authentication!
debug:
  enabled: false
  auth:
    # Bearer token for debug endpoint authentication
    # If set, requires "Authorization: Bearer <token>" header
    # If not set, falls back to main auth credentials
    token: "${CAPFOX_DEBUG_TOKEN}"

# Decision Engine Configuration
decision:
  # Strategy for making decisions
  # - threshold: only check current state against thresholds
  # - predictive: predict future state and check thresholds
  # - conservative: predictive + safety buffer
  # - queue_aware: consider pending tasks
  strategy: "predictive"

  # Prediction model
  # - none: no prediction (for threshold strategy)
  # - moving_average: simple average (doesn't use complexity)
  # - linear: linear regression (complexity affects prediction)
  # - polynomial: polynomial regression
  # - gradient_boosting: ML-based (batch training)
  model: "linear"

  # Fallback when insufficient data for prediction
  fallback_strategy: "threshold"

  # Minimum observations before using predictions
  # Research shows N >= 10 minimum, N >= 25 recommended for reliable predictions
  min_observations: 10

  # Safety buffer for conservative strategy (percentage)
  safety_buffer_percent: 10

  # Model-specific parameters
  model_params:
    # Moving average smoothing factor (0.1-0.3)
    alpha: 0.2

    # Polynomial degree (2-3)
    degree: 2

    # Gradient boosting parameters
    n_estimators: 100
    max_depth: 5
    retrain_interval: "1h"
    min_retrain_samples: 50
    max_buffer_size: 10000
